// User Management System
class UserManager{constructor(){this.users=JSON.parse(localStorage.getItem("registeredUsers"))||[];this.currentUser=JSON.parse(localStorage.getItem("currentUser"))||null}getCurrentUser(){return this.currentUser}updateUserProfile(e){if(this.currentUser){const t=this.users.findIndex(t=>t.id===this.currentUser.id);if(t!==-1){Object.assign(this.users[t],e);localStorage.setItem("registeredUsers",JSON.stringify(this.users));Object.assign(this.currentUser,e);localStorage.setItem("currentUser",JSON.stringify(this.currentUser));return{success:true,message:"Profile updated successfully!"}}}return{success:false,message:"User not found!"}}}const userManager=new UserManager;let forceLoadImages=false;function showNotification(e){const t=document.createElement("div");t.className="notification";t.innerHTML=`<i class="fas fa-check-circle"></i> ${e}`;t.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #4CAF50;
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 9999999;
        animation: slideIn 0.3s ease;
    `;document.body.appendChild(t);setTimeout(()=>{t.style.animation="slideOut 0.3s ease";setTimeout(()=>t.remove(),300)},3e3)}function goToEditProfile(){window.location.href="update2.html"}function createAvatarPlaceholder(e){const t=e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);const a=["#DA2700","#FFA700","#4CAF50","#2196F3","#9C27B0"];const n=e.charCodeAt(0)%a.length;const i=a[n];return`
        <div class="avatar-placeholder" style="
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background-color: ${i};
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 40px;
            position: absolute;
            top: 0;
            left: 0;
        ">${t}</div>
    `}let currentUser=null;let teamsData=[];const availablePlayers=[];const sampleTeams=[{id:1,name:"Shadow Warriors",game:"BGMI",description:"A team of elite BGMI players with a focus on strategy and precision.",image:"https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/c5c6cf7b-5b14-4862-8787-b414dd0e4c35.png",created:"2024-01-15",members:[{id:1,name:"John Doe",role:"Captain",avatar:"https://i.pravatar.cc/150?img=1"},{id:2,name:"Jane Smith",role:"Sniper",avatar:"https://i.pravatar.cc/150?img=2"},{id:3,name:"Mike Johnson",role:"Support",avatar:"https://i.pravatar.cc/150?img=3"}]},{id:2,name:"Cyber Legends",game:"cs2",description:"Fierce CS-2 squad aiming for the top in all tournaments.",image:"https://cdn.shopify.com/s/files/1/0636/5226/6115/files/wp12817914-cs2-wallpapers.png?v=1750919735",created:"2024-02-20",members:[{id:4,name:"Alex Pro",role:"IGL",avatar:"https://i.pravatar.cc/150?img=4"},{id:5,name:"Sarah Elite",role:"AWPer",avatar:"https://i.pravatar.cc/150?img=5"}]}];const samplePlayers=[{id:101,name:"Gaming Pro",username:"@gamingpro",avatar:"https://i.pravatar.cc/150?img=10",stats:"K/D: 2.5 | Rank: Global Elite"},{id:102,name:"Sniper King",username:"@sniperking",avatar:"https://i.pravatar.cc/150?img=11",stats:"K/D: 3.2 | Rank: Supreme"},{id:103,name:"Rush Master",username:"@rushmaster",avatar:"https://i.pravatar.cc/150?img=12",stats:"K/D: 1.8 | Rank: Legendary Eagle"},{id:104,name:"Tactical Genius",username:"@tactical",avatar:"https://i.pravatar.cc/150?img=13",stats:"K/D: 2.1 | Rank: Distinguished Master"},{id:105,name:"Clutch God",username:"@clutchgod",avatar:"https://i.pravatar.cc/150?img=14",stats:"K/D: 2.8 | Rank: Global Elite"},{id:106,name:"Spray Control",username:"@spraycontrol",avatar:"https://i.pravatar.cc/150?img=15",stats:"K/D: 2.0 | Rank: Supreme"}];const profileDropdownToggle=document.getElementById("profileDropdownToggle");const profileMenu=document.getElementById("profileMenu");const profileEmailElem=document.getElementById("profileEmail");const profileEmailBanner=document.getElementById("profileEmailBanner");const profileIcon=document.getElementById("profileIcon");const bannerAvatar=document.getElementById("bannerAvatar");const preloader=document.getElementById("preloader");const generalTab=document.getElementById("generalTab");const teamsTab=document.getElementById("teamsTab");const tabButtons=document.querySelectorAll(".tab-btn");const teamCardsContainer=document.getElementById("teamCards");const filterTeams=document.getElementById("filterTeams");const btnCreateTeam=document.getElementById("btnCreateTeam");const btnLogout=document.getElementById("btn-logout");const teamModal=document.getElementById("teamModal");const teamModalClose=document.getElementById("teamModalClose");const teamModalTitle=document.getElementById("teamModalTitle");const teamModalLogo=document.getElementById("teamModalLogo");const teamModalGame=document.getElementById("teamModalGame");const teamModalCreated=document.getElementById("teamModalCreated");const teamModalMemberCount=document.getElementById("teamModalMemberCount");const teamModalStatus=document.getElementById("teamModalStatus");const teamMembersGrid=document.getElementById("teamMembersGrid");const invitePlayersBtn=document.getElementById("invitePlayersBtn");const playerInviteModal=document.getElementById("playerInviteModal");const playerInviteModalClose=document.getElementById("playerInviteModalClose");const playerSearchInput=document.getElementById("playerSearchInput");const playersList=document.getElementById("playersList");let currentTeamId=null;const invitedPlayers=new Set;function isInViewport(e){if(!e)return false;const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function updateAllAvatarImages(e){document.querySelectorAll(".avatar-placeholder").forEach(e=>e.remove());document.querySelectorAll("[data-user-avatar]").forEach(t=>{if(t.classList.contains("lazy-image")){t.dataset.src=e;if(isInViewport(t)||forceLoadImages){t.src=e}}else{t.src=e}t.style.opacity="1";t.style.display="block"});if(profileIcon){if(profileIcon.classList.contains("lazy-image")){profileIcon.dataset.src=e;if(isInViewport(profileIcon)||forceLoadImages){profileIcon.src=e}}else{profileIcon.src=e}profileIcon.style.display="block"}if(bannerAvatar){if(bannerAvatar.classList.contains("lazy-image")){bannerAvatar.dataset.src=e;if(isInViewport(bannerAvatar)||forceLoadImages){bannerAvatar.src=e}}else{bannerAvatar.src=e}bannerAvatar.style.opacity="1"}if(currentUser){currentUser.avatar=e}userManager.updateUserProfile({avatar:e})}function initLazyLoading(){const e=document.querySelectorAll(".lazy-image");if("IntersectionObserver"in window){const t=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const a=e.target;if(a.dataset.src){const n=new Image;n.onload=function(){a.src=a.dataset.src;a.classList.remove("lazy-image");a.classList.add("loaded");t.unobserve(a)};n.onerror=function(){console.error("Error loading image:",a.dataset.src);if(a.getAttribute("onerror")){}else{a.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='%23ffa700' d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z'/%3E%3C/svg%3E"}t.unobserve(a)};n.src=a.dataset.src}}})},{rootMargin:"50px 0px",threshold:.1});e.forEach(e=>{t.observe(e)})}else{forceLoadImages=true;e.forEach(e=>{if(e.dataset.src){e.src=e.dataset.src}})}window.addEventListener("scroll",throttle(lazyLoadImages,200));window.addEventListener("resize",throttle(lazyLoadImages,200));window.addEventListener("orientationchange",throttle(lazyLoadImages,200));lazyLoadImages()}function lazyLoadImages(){const e=document.querySelectorAll(".lazy-image:not(.loaded)");e.forEach(e=>{if(isInViewport(e)&&e.dataset.src){e.src=e.dataset.src;e.classList.remove("lazy-image");e.classList.add("loaded")}})}function throttle(e,t){let a;return function(){const n=arguments;const i=this;if(!a){e.apply(i,n);a=true;setTimeout(()=>a=false,t)}}}function loadUserProfile(){const e=localStorage.getItem("profileViewData");const t=userManager.getCurrentUser();const a=e?JSON.parse(e):t;if(!a){console.log("No user logged in");alert("Please log in to view your profile");return}currentUser={id:a.id,email:a.email,name:a.name,avatar:a.avatar,nickname:a.nickname||"",country:a.country||"",bio:a.bio||"",joinDate:a.createdAt,status:a.status||"online",statistics:{playedTournaments:a.playedTournaments||0,playedMatches:a.playedMatches||0,wonMatches:a.wonMatches||0,trophies:a.trophies||{bronze:0,silver:0,gold:0}}};updateProfileDisplay()}function updateProfileDisplay(){if(!currentUser)return;requestAnimationFrame(()=>{if(profileEmailElem)profileEmailElem.textContent=currentUser.email;if(profileEmailBanner)profileEmailBanner.textContent=currentUser.name||currentUser.email;const e=document.getElementById("profileNickname");const t=document.getElementById("profileCountry");const a=document.getElementById("profileJoinDate");const n=document.getElementById("profileBio");if(e)e.textContent=`In Game Name: ${currentUser.nickname||"Not set"}`;if(t)t.textContent=`Country: ${currentUser.country||"Not set"}`;if(a)a.textContent=`Date of joining: ${currentUser.joinDate?(new Date(currentUser.joinDate)).toLocaleDateString():"Unknown"}`;if(n)n.textContent=`Description: ${currentUser.bio||"No description added"}`;const i=document.getElementById("statPlayedTournaments");const o=document.getElementById("statPlayedMatches");const s=document.getElementById("statWonMatches");if(i)i.textContent=currentUser.statistics.playedTournaments;if(o)o.textContent=currentUser.statistics.playedMatches;if(s)s.textContent=currentUser.statistics.wonMatches});setTimeout(()=>{if(currentUser.avatar){updateAllAvatarImages(currentUser.avatar)}else{handleNoAvatar()}},100)}function handleNoAvatar(){const e=createAvatarPlaceholder(currentUser.name||currentUser.email);const t=[{element:bannerAvatar,container:bannerAvatar?.parentElement},{element:profileIcon,container:profileIcon?.parentElement}];t.forEach(({element:t,container:a})=>{if(t&&a&&!a.querySelector(".avatar-placeholder")){t.style.opacity="0";a.insertAdjacentHTML("afterbegin",e)}})}function toggleProfileMenu(){const e=profileDropdownToggle.getAttribute("aria-expanded")==="true";profileDropdownToggle.setAttribute("aria-expanded",!e);if(!e){profileMenu.classList.remove("invisible","opacity-0");profileMenu.classList.add("visible","opacity-100")}else{profileMenu.classList.add("invisible","opacity-0");profileMenu.classList.remove("visible","opacity-100")}}function hideProfileMenu(){profileDropdownToggle.setAttribute("aria-expanded",false);profileMenu.classList.add("invisible","opacity-0");profileMenu.classList.remove("visible","opacity-100")}function switchTab(e){tabButtons.forEach(t=>{const a=t.dataset.tab===e;t.setAttribute("aria-selected",a);if(a){t.classList.add("border-b-2","border-yellow-400","text-[#FFA700]")}else{t.classList.remove("border-b-2","border-yellow-400","text-[#FFA700]")}});generalTab.classList.toggle("hidden",e!=="general");teamsTab.classList.toggle("hidden",e!=="teams");document.getElementById("walletSection").classList.add("hidden")}function showWalletSection(){generalTab.classList.add("hidden");teamsTab.classList.add("hidden");document.getElementById("walletSection").classList.remove("hidden")}function renderTeams(e="all"){teamCardsContainer.innerHTML="";let t=teamsData;if(e!=="all"){t=teamsData.filter(t=>t.game.toLowerCase()===e.toLowerCase())}if(t.length===0){teamCardsContainer.innerHTML="<p class='col-span-full text-center text-gray-500'>No teams found for this filter.</p>";return}t.forEach(e=>{const t=createTeamCard(e);teamCardsContainer.appendChild(t)})}function createTeamCard(e){const t=document.createElement("div");t.className="card rounded-lg p-4 shadow-md flex flex-col border border-gray-700 hover:border-yellow-400 transition-all duration-300";t.style.backgroundColor="#141414";t.style.marginleft="90px";t.tabIndex=0;t.setAttribute("role","article");t.innerHTML=`
        <img src="${e.image}" alt="Team banner for ${e.name}" class="rounded-md w-full h-40 object-cover mb-3" onerror="this.src='https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e6e8d664-e8df-4d08-b3e4-8184c53a0d5f.png'"/>
        <h4 class="text-[#FFA700] font-semibold mb-1">${e.name}</h4>
        <p class="text-gray-300 text-sm flex-grow">${e.description}</p>
        <div class="mt-3 flex justify-between items-center">
            <span class="text-xs text-gray-400">${e.game.toUpperCase()}</span>
            <span class="text-xs text-gray-400">${e.members.length} members</span>
        </div>
    `;t.onclick=()=>openTeamModal(e);return t}function openTeamModal(e){currentTeamId=e.id;teamModalTitle.textContent=e.name;teamModalLogo.src=e.image;teamModalLogo.alt=`${e.name} logo`;teamModalGame.textContent=e.game.toUpperCase();teamModalCreated.textContent=new Date(e.created).toLocaleDateString();teamModalMemberCount.textContent=`${e.members.length}/5`;teamModalStatus.textContent="Active";renderTeamMembers(e.members);teamModal.classList.add("show");document.body.style.overflow="hidden"}function renderTeamMembers(e){teamMembersGrid.innerHTML="";e.forEach(e=>{const t=document.createElement("div");t.className="member-card";t.innerHTML=`
            <img src="${e.avatar}" alt="${e.name}" class="member-avatar">
            <div class="member-name">${e.name}</div>
            <div class="member-role">${e.role}</div>
        `;teamMembersGrid.appendChild(t)});const t=5-e.length;for(let e=0;e<t;e++){const t=document.createElement("div");t.className="empty-slot";t.innerHTML=`
            <i class="fas fa-plus"></i>
            <span>Empty Slot</span>
        `;t.onclick=()=>openPlayerInviteModal();teamMembersGrid.appendChild(t)}}function closeTeamModal(){teamModal.classList.remove("show");document.body.style.overflow="auto";currentTeamId=null}function openPlayerInviteModal(){playerSearchInput.value="";renderAvailablePlayers(samplePlayers);playerInviteModal.classList.add("show")}function closePlayerInviteModal(){playerInviteModal.classList.remove("show")}function renderAvailablePlayers(e){playersList.innerHTML="";if(e.length===0){playersList.innerHTML='<div class="text-center text-gray-500 py-8">No players found</div>';return}e.forEach(e=>{const t=invitedPlayers.has(e.id);const a=document.createElement("div");a.className=`player-item ${t?"invited":""}`;a.innerHTML=`
            <img src="${e.avatar}" alt="${e.name}" class="player-item-avatar">
            <div class="player-item-info">
                <div class="player-item-name">${e.name}</div>
                <div class="player-item-stats">${e.stats}</div>
            </div>
            <button class="player-invite-btn" ${t?"disabled":""} onclick="invitePlayer(${e.id}, '${e.name}')">
                ${t?"Invited":"Invite"}
            </button>
        `;playersList.appendChild(a)})}function invitePlayer(e,t){invitedPlayers.add(e);const a=event.target.closest(".player-item");a.classList.add("invited");event.target.textContent="Invited";event.target.disabled=true;showNotification(`Invitation sent to ${t}!`);console.log(`Inviting player ${e} to team ${currentTeamId}`)}function searchPlayers(){const e=playerSearchInput.value.toLowerCase();const t=samplePlayers.filter(t=>t.name.toLowerCase().includes(e)||t.username.toLowerCase().includes(e));renderAvailablePlayers(t)}function openCreateTeamModal(){const e=document.createElement("form");e.className="space-y-4";e.innerHTML=`
        <h3 class="text-[#FFA700] text-xl font-bold mb-4">Create My Team</h3>
        <label class="block text-gray-200 font-semibold">Team Name <input required name="name" type="text" class="w-full mt-1 px-3 py-2 rounded bg-[#141414] focus:ring-yellow-400 focus:outline-none text-gray-200" /></label>
        <label class="block text-gray-200 font-semibold">Game <select required name="game" class="w-full mt-1 px-3 py-2 rounded bg-[#141414] focus:ring-yellow-400 focus:outline-none text-gray-200">
          <option value="">Select game</option>
          <option value="BGMI">BGMI</option>
          <option value="cs2">CS-2</option>
          <option value="valorant">Valorant</option>
        </select></label>
        <label class="block text-gray-200 font-semibold">Description <textarea required name="description" rows="3" class="w-full mt-1 px-3 py-2 rounded bg-[#141414] focus:ring-yellow-400 focus:outline-none text-gray-200"></textarea></label>
        <label class="block text-gray-200 font-semibold">Image URL <input name="image" type="url" placeholder="https://example.com/image.png" class="w-full mt-1 px-3 py-2 rounded bg-[#141414] focus:ring-yellow-400 focus:outline-none text-gray-200" /></label>
        <div class="flex justify-end space-x-2">
          <button type="submit" class="primary-btn bg-[#FFa700] hover:bg-[#DF2A00] px-4 py-2 rounded font-semibold transition">Create</button>
          <button type="button" id="cancelCreateTeam" class="bg-[#FFa700] hover:bg-[#DF2A00] px-4 py-2 rounded font-semibold transition">Cancel</button>
        </div>
    `;e.onsubmit=t=>{t.preventDefault();const a=new FormData(e);const n={id:Date.now(),name:a.get("name").trim(),game:a.get("game"),description:a.get("description"),image:a.get("image")||"https://placehold.co/400x160/png?text=No+Image",created:(new Date).toISOString().split("T")[0],members:[{id:currentUser.id,name:currentUser.name,role:"Captain",avatar:currentUser.avatar||"https://i.pravatar.cc/150?img=1"}]};teamsData.push(n);renderTeams(filterTeams.value);closeModal();showNotification("Team created successfully!")};e.querySelector("#cancelCreateTeam").onclick=closeModal;openModal(e)}function openModal(e){const t=document.getElementById("modalBg");const a=document.getElementById("modalBody");a.innerHTML="";a.appendChild(e);t.classList.remove("hidden");t.classList.add("flex");t.focus()}function closeModal(){const e=document.getElementById("modalBg");const t=document.getElementById("modalBody");e.classList.remove("flex");e.classList.add("hidden");t.innerHTML=""}function init(){const e=userManager.getCurrentUser();if(!e){console.log("No user logged in");gsap.to(".preloader",{y:"-100%",duration:1.2,ease:"power3.inOut",onComplete:function(){$(".preloader").hide()}});alert("Please log in to view your profile");return}loadUserProfile();setTimeout(()=>{gsap.to(".preloader",{y:"-100%",duration:.8,ease:"power3.out",onComplete:function(){$(".preloader").hide();setTimeout(()=>{document.querySelectorAll(".lazy-image").forEach(e=>{if(isInViewport(e)&&e.dataset.src){e.src=e.dataset.src}})},100)}})},300);teamsData=[...sampleTeams];renderTeams();$(".preloaderCls").on("click",function(e){e.preventDefault();gsap.to(".preloader",{y:"-100%",duration:1.2,ease:"power3.inOut",onComplete:function(){$(".preloader").hide()}})});initLazyLoading();if(profileDropdownToggle){profileDropdownToggle.onclick=()=>{const e=profileDropdownToggle.getAttribute("aria-expanded")==="true";if(e)hideProfileMenu();else toggleProfileMenu()}}document.addEventListener("click",e=>{if(profileDropdownToggle&&profileMenu&&!profileDropdownToggle.contains(e.target)&&!profileMenu.contains(e.target)){hideProfileMenu()}});if(btnLogout){btnLogout.onclick=()=>{localStorage.removeItem("currentUser");localStorage.removeItem("userData");localStorage.removeItem("friendsList");localStorage.removeItem("profileViewData");currentUser=null;window.location.href="index.html"}}const t=document.getElementById("menu-general");if(t)t.onclick=()=>{switchTab("general");hideProfileMenu()};const a=document.getElementById("menu-teams");if(a)a.onclick=()=>{switchTab("teams");hideProfileMenu()};const n=document.getElementById("menu-wallet");if(n)n.onclick=()=>{showWalletSection();hideProfileMenu()};tabButtons.forEach(e=>{e.addEventListener("click",()=>switchTab(e.dataset.tab))});if(filterTeams){filterTeams.addEventListener("change",()=>{renderTeams(filterTeams.value)})}if(btnCreateTeam){btnCreateTeam.onclick=openCreateTeamModal}if(teamModalClose){teamModalClose.onclick=closeTeamModal}if(invitePlayersBtn){invitePlayersBtn.onclick=openPlayerInviteModal}if(playerInviteModalClose){playerInviteModalClose.onclick=closePlayerInviteModal}if(playerSearchInput){playerSearchInput.addEventListener("input",searchPlayers)}teamModal.addEventListener("click",e=>{if(e.target===teamModal){closeTeamModal()}});playerInviteModal.addEventListener("click",e=>{if(e.target===playerInviteModal){closePlayerInviteModal()}});const i=document.getElementById("modalCloseBtn");if(i){i.onclick=closeModal}const o=document.getElementById("modalBg");if(o){o.addEventListener("click",e=>{if(e.target===o)closeModal()})}document.addEventListener("keydown",e=>{if(e.key==="Escape"){if(!teamModal.classList.contains("show")&&!playerInviteModal.classList.contains("show")){const e=document.getElementById("modalBg");if(e&&!e.classList.contains("hidden")){closeModal()}}else if(playerInviteModal.classList.contains("show")){closePlayerInviteModal()}else if(teamModal.classList.contains("show")){closeTeamModal()}}})}(()=>{const e=document.getElementById("gamesModal");const t=document.getElementById("addAccountModal");const a=document.getElementById("openGamesModalBtn");const n=document.getElementById("closeGamesModal");const i=document.getElementById("closeAddAccountModal");const o=document.getElementById("gameCards");const s=document.getElementById("createdAccounts");const r=document.getElementById("noAccountsMessage");const l=document.getElementById("clearAllAccountsBtn");const d=document.getElementById("accountForm");const c=document.getElementById("connectAccountBtn");const m=document.getElementById("platform");const u=document.getElementById("inGameName");const p=document.getElementById("steamId");const f=document.getElementById("gameLogo");const g=[{id:"cs2",name:"Counter Strike2",logo:"https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/ece12ab8-d823-49cf-8b58-1f08f84eb2be.png",alt:"Counter Strike Global Offensive game logo with gray background and white text"}];let h=null;function y(){const e=localStorage.getItem("gameAccounts");if(!e)return[];try{return JSON.parse(e)}catch(e){return[]}}function v(e){localStorage.setItem("gameAccounts",JSON.stringify(e))}function b(){if(!o)return;o.innerHTML="";g.forEach(e=>{const t=document.createElement("button");t.type="button";t.className=" h- 20vh game-card bg-gray-700 rounded-lg shadow-md flex flex-col items-center text-center p-4 hover:bg-yellow-600 hover:text-black transition focus:outline-none border border-gray-600 hover:border-yellow-400";t.style.height="20vh";t.style.backgroundColor="#141414";t.setAttribute("aria-label",`Select ${e.name} to add account`);t.dataset.gameId=e.id;const a=document.createElement("img");a.src=e.logo;a.alt=e.alt;a.className="mb-3 h-12 object-contain";a.onerror=function(){this.style.display="none"};const n=document.createElement("span");n.textContent=e.name;n.className="font-semibold text-lg text-white";t.appendChild(a);t.appendChild(n);t.addEventListener("click",()=>w(e.id));o.appendChild(t)})}function I(){if(!s||!r)return;const e=y();s.innerHTML="";if(e.length===0){r.style.display="block";l.disabled=true;return}r.style.display="none";l.disabled=false;e.forEach((e,t)=>{const a=document.createElement("section");a.className="bg-gray-700 rounded-lg p-4 flex flex-col shadow-md text-sm relative hover:ring-2 ring-yellow-400 transition border border-gray-600";a.style.backgroundColor="#141414";const n=g.find(t=>t.id===e.gameId);let i="";let o="";if(n){i=n.logo;o=n.alt}const r=document.createElement("div");r.className="absolute top-3 left-3 w-10 h-10 bg-gray-900 rounded-md flex items-center justify-center shadow-inner";const l=document.createElement("img");l.src=i;l.alt=o;l.className="max-h-8 max-w-full object-contain";l.onerror=function(){this.style.display="none"};r.appendChild(l);a.appendChild(r);const d=document.createElement("div");d.className="pl-14 space-y-1";const c=document.createElement("p");c.textContent=n?n.name:"Unknown Game";c.className="font-semibold text-white";const m=document.createElement("p");m.textContent=`Platform: ${e.platform}`;const u=document.createElement("p");u.textContent=`In-game name: ${e.inGameName}`;const p=document.createElement("p");p.textContent=`Steam ID: ${e.steamId||"N/A"}`;d.appendChild(c);d.appendChild(m);d.appendChild(u);d.appendChild(p);a.appendChild(d);const f=document.createElement("button");f.setAttribute("aria-label","Delete this account");f.title="Delete this account";f.className="absolute top-3 right-3 text-red-500 hover:text-red-400 transition focus:outline-none";f.innerHTML=`
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            `;f.addEventListener("click",e=>{e.stopPropagation();L(t)});a.appendChild(f);s.appendChild(a)})}function L(e){const t=y();if(e>=0&&e<t.length){t.splice(e,1);v(t);I()}}if(l){l.addEventListener("click",()=>{if(confirm("Are you sure you want to delete all saved accounts?")){localStorage.removeItem("gameAccounts");I()}})}function w(e){if(!t)return;h=g.find(t=>t.id===e);if(!h)return;d.reset();T();f.src=h.logo;f.alt=h.alt;t.classList.remove("hidden");if(e)e.classList.add("hidden");m.focus()}function k(){if(!t)return;t.classList.add("hidden");if(e)e.classList.remove("hidden");h=null}function T(){if(!c||!m||!u)return;const e=m.value.trim()&&u.value.trim();c.disabled=!e}if(d){d.addEventListener("submit",e=>{e.preventDefault();if(!h)return;const t=new FormData(d);const a={gameId:h.id,platform:t.get("platform"),inGameName:t.get("inGameName"),steamId:t.get("steamId")||"",createdAt:(new Date).toISOString()};const n=y();n.push(a);v(n);I();k();showNotification(`${h.name} account added successfully!`)})}if(m){m.addEventListener("input",T)}if(u){u.addEventListener("input",T)}if(a){a.addEventListener("click",()=>{if(e){e.classList.remove("hidden");b();I()}})}if(n){n.addEventListener("click",()=>{if(e)e.classList.add("hidden")})}if(i){i.addEventListener("click",k)}if(e){e.addEventListener("click",t=>{if(t.target===e){e.classList.add("hidden")}})}if(t){t.addEventListener("click",e=>{if(e.target===t){k()}})}b();I()})();document.addEventListener("DOMContentLoaded",init);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("openTeamModalBtn");const t=document.getElementById("gameModal");const a=document.getElementById("closeModal");const n=document.querySelector(".select-btn");const i=document.getElementById("createTeamForm");const o=document.getElementById("closeForm");const s=document.getElementById("cancelForm");const r=document.getElementById("teamCardsContainer");const l=document.querySelectorAll(".join-btn");const d=document.getElementById("joinTypeInfo");const c=document.querySelector('textarea[name="about"]');const m=document.getElementById("charCount");e.addEventListener("click",()=>{t.style.display="flex"});a.addEventListener("click",()=>{t.style.display="none"});n.addEventListener("click",()=>{t.style.display="none";i.style.display="block"});o.addEventListener("click",()=>i.style.display="none");s.addEventListener("click",()=>i.style.display="none");l.forEach(e=>{e.addEventListener("click",()=>{l.forEach(e=>e.classList.remove("active"));e.classList.add("active");d.textContent=e.dataset.type==="Public"?"Anybody can apply to join the team":"Only invited users can join the team"})});c.addEventListener("input",()=>{m.textContent=c.value.length});document.getElementById("teamForm").addEventListener("submit",e=>{e.preventDefault();const t=new FormData(e.target);const a={teamName:t.get("teamName"),platform:t.get("platform"),about:t.get("about"),joinType:document.querySelector(".join-btn.active").dataset.type,allowTournament:t.get("tournament")?true:false};let n=JSON.parse(localStorage.getItem("teams"))||[];n.push(a);localStorage.setItem("teams",JSON.stringify(n));u();e.target.reset();m.textContent="0";i.style.display="none"});function u(){r.innerHTML="";const e=JSON.parse(localStorage.getItem("teams"))||[];e.forEach((e,t)=>{const a=document.createElement("div");a.className="team-card";a.innerHTML=`
      <h3 class="team-name">${e.teamName}</h3>
      <p><strong>Platform:</strong> ${e.platform}</p>
      <p><strong>About:</strong> ${e.about}</p>
      <p><strong>Join Type:</strong> ${e.joinType}</p>
      <p><strong>Tournament Access:</strong> ${e.allowTournament?"✅ Allowed":"❌ Not Allowed"}</p>
      <button class="delete-btn" data-index="${t}">Delete</button>
    `;a.addEventListener("click",t=>{if(t.target.classList.contains("delete-btn"))return;localStorage.setItem("selectedTeam",JSON.stringify(e));window.location.href="team-profile.html"});r.appendChild(a)});const t=document.querySelectorAll(".delete-btn");t.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const a=e.getAttribute("data-index");let n=JSON.parse(localStorage.getItem("teams"))||[];n.splice(a,1);localStorage.setItem("teams",JSON.stringify(n));u()})})}u()});const openBtn=document.getElementById("openSocialModalBtn");const modal=document.getElementById("socialModal");const closeBtn=document.getElementById("closeSocialModalBtn");const closeX=document.getElementById("closeSocialModalX");const saveBtn=document.getElementById("saveSocialLinksBtn");const displaySection=document.getElementById("socialLinksDisplay");openBtn.addEventListener("click",()=>{modal.style.display="flex"});[closeBtn,closeX].forEach(e=>e.addEventListener("click",()=>modal.style.display="none"));window.addEventListener("click",e=>{if(e.target===modal)modal.style.display="none"});saveBtn.addEventListener("click",()=>{const e={discord:document.getElementById("discordInput").value,facebook:document.getElementById("facebookInput").value,twitter:document.getElementById("twitterInput").value,instagram:document.getElementById("instagramInput").value,twitch:document.getElementById("twitchInput").value,youtube:document.getElementById("youtubeInput").value};localStorage.setItem("socialLinks",JSON.stringify(e));renderSocialLinks();modal.style.display="none"});function renderSocialLinks(){const e=JSON.parse(localStorage.getItem("socialLinks"));displaySection.innerHTML="";if(!e)return;for(const[t,a]of Object.entries(e)){if(a.trim()!==""){const e=document.createElement("a");e.href=a;e.target="_blank";e.className="social-icon";e.textContent=t.charAt(0).toUpperCase()+t.slice(1);displaySection.appendChild(e)}}}document.addEventListener("DOMContentLoaded",renderSocialLinks);
